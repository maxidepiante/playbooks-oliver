---
- name: ğŸ› ï¸ Mantenimiento AutomÃ¡tico - Servidor Zabbix
  hosts: zabbix_servers
  gather_facts: yes
  become: yes
  
  tasks:
    - name: ğŸ“Š Verificar informaciÃ³n del sistema
      debug:
        msg: |
          DistribuciÃ³n: {{ ansible_distribution }}
          VersiÃ³n: {{ ansible_distribution_version }}
          Gestor de paquetes: {{ ansible_pkg_mgr }}
          
    - name: ğŸ“¦ ACTUALIZAR SISTEMA (forzado)
      package:
        name: "*"
        state: latest
      
    - name: ğŸ§¹ Limpiar cache
      shell: "{{ ansible_pkg_mgr }} clean all"
      
    - name: ğŸ“Š Verificar espacio
      shell: df -h
      register: disk_space
      
    - name: ğŸ“‹ Mostrar espacio
      debug:
        var: disk_space.stdout
        
    - name: ğŸ” Verificar servicios
      systemd:
        name: "{{ item }}"
        state: started
      with_items:
        - zabbix-server
        - zabbix-agent
      ignore_errors: yes
