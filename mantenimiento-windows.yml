---
- name: ğŸ› ï¸ Mantenimiento AutomÃ¡tico - Windows Server 2019
  hosts: windows-server
  gather_facts: no

  tasks:
    - name: ğŸ” PRUEBA - Comando simple de test
      win_shell: echo "âœ… ConexiÃ³n SSH funcionando"
      register: test_cmd

    - name: ğŸ“‹ Mostrar resultado test
      debug:
        msg: "{{ test_cmd.stdout }}"

    - name: ğŸ“Š Verificar informaciÃ³n del sistema
      win_shell: systeminfo
      register: system_info_full

    - name: ğŸ“‹ Mostrar informaciÃ³n completa del sistema
      debug:
        msg: "{{ system_info_full.stdout }}"

    - name: ğŸ§¹ Limpiar archivos temporales
      win_shell: |
        Write-Output "Limpiando archivos temporales..."
        Get-ChildItem "C:\Windows\Temp\*" -ErrorAction SilentlyContinue | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue
        Get-ChildItem "C:\Temp\*" -ErrorAction SilentlyContinue | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue
        Write-Output "Limpieza completada"
      register: cleanup

    - name: ğŸ“‹ Mostrar resultado limpieza
      debug:
        msg: "{{ cleanup.stdout }}"

    - name: ğŸ“Š Verificar espacio en disco
      win_shell: Get-PSDrive C
      register: disk_space

    - name: ğŸ“‹ Mostrar espacio en disco
      debug:
        msg: "{{ disk_space.stdout }}"

    - name: âœ… FINALIZADO
      debug:
        msg: "âœ… Mantenimiento Windows completado"
